<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <link rel="shortcut icon" type="image/png" href="{{ url_for('static', filename='img/nexttech-icon.png') }}">
  <title>Tender Details</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- Bootstrap core CSS -->
  <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link href="{{ url_for('static', filename='css/mdb.min.css') }}" rel="stylesheet">
  <!-- Your custom styles (optional) -->
  <link href="{{ url_for('static', filename='css/style.min.css') }}" rel="stylesheet">


<style>
#customers {
    font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

#customers td, #customers th {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

#customers tr:nth-child(even){background-color: #f2f2f2;}

#customers tr:hover {background-color: #ddd;}

#customers th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: left;
    background-color: #4CAF50;
    color: white;
}
</style>

<style>
header {
    font-family: 'Roboto';
}
</style>
<style type="text/css">
  .btn-round-lg{
border-radius: 22.5px;
font-family: 'Roboto';font-size: 15px;
}
</style>
<link href='https://fonts.googleapis.com/css' rel='stylesheet'>

<script src="./node_modules/web3/dist/web3.min.js"></script>

</head>

<body>

  <!-- Navbar -->
      <nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar">
        <div class="container">

          <!-- Brand -->
          <a class="navbar-brand" href="{{ url_for('index') }}">
            <button type="button" class="btn btn-default btn-round-lg"><strong>Team Satoshi</strong></button>
          </a>

          <!-- Collapse -->
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <!-- Links -->
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <!-- Left -->
            <ul class="navbar-nav mr-auto">

              <li class="nav-item">
                <a class="nav-link" href="{{ url_for('whitepaper') }}"><strong>Whitepaper</strong></a>
              </li>


            </ul>

            <!-- Right -->
            <ul class="navbar-nav nav-flex-icons">

              {% if session['logged_in'] or session['dealer_logged_in'] %}
              <li class="nav-item">
                  <a href="{{ url_for('userpage') }}" class="nav-link border border-light rounded">
                    <i class="fa fa-user mr-2"></i>{{user}}
                  </a>
                </li>
              {% else %}
              <li class="nav-item">
                  <a href="{{ url_for('login') }}" class="nav-link border border-light rounded">
                    <i class="fa fa-user mr-2"></i>Login
                  </a>
                </li>&nbsp;&nbsp;
                <li class="nav-item">
                  <a href="{{ url_for('register') }}" class="nav-link border border-light rounded">
                    <i class="fa fa-user mr-2"></i>Sign Up
                  </a>
                </li>
              {% endif %}
            </ul>
          </div>
        </div>
      </nav>
      <!-- Navbar -->

  <!--Main layout-->
  <main class="mt-5 pt-4">
    <div class="container">

      <h3 class="my-5 h3 text-center">Tender details</h3>

     <table id="customers">
    <tr>
    <th>Bid Closing Date</th>
    <td>{{data[0]}}</td>
    <th>Bid Opening Place</th>
    <td>{{data[1]}}</td>
    <th>Bid Opening Date</th>
    <td>{{data[2]}}</td>
  </tr>
  <tr>
    <th>Clarification End Date</th>
    <td>{{data[3]}}</td>
    <th>Clarification Start Date</th>
    <td>{{data[4]}}</td>
    <th>Document Download End Date</th>
    <td>{{data[5]}}</td>
  </tr>
  <tr>
    <th>Document Download Start Date</th>
    <td>{{data[6]}}</td>
    <th>Finance Details</th>
    <td>{{data[7]}}</td>
    <th>Form of Contract</th>
    <td>{{data[8]}}</td>
  </tr>
    <tr>
    <th>Gen.Tech.Eval.Allowed</th>
    <td>{{data[9]}}</td>
    <th>IndependentExternalMonitor</th>
    <td>{{data[10]}}</td>
    <th>Meet Address</th>
    <td>{{data[11]}}</td>
  </tr>
    <tr>
    <th>Meet Date</th>
    <td>{{data[12]}}</td>
    <th>Multicurrency allow</th>
    <td>{{data[13]}}</td>
    <th>Organisation</th>
    <td>{{data[14]}}</td>
  </tr>
    <tr>
    <th>Payment mode</th>
    <td>{{data[15]}}</td>
    <th>Payee Name</th>
    <td>{{data[16]}}</td>
    <th>Person Address</th>
    <td>{{data[17]}}</td>
  </tr>
    <tr>
    <th>Person Name</th>
    <td>{{data[18]}}</td>
    <th>PreQualification</th>
    <td>{{data[19]}}</td>
    <th>PublishedDate</th>
    <td>{{data[20]}}</td>
  </tr>
</table>

<br><br>

      <!--Grid row-->
      <div class="row d-flex justify-content-center">

        <!--
        <div class="col-md-8 text-center">

          <p class="mb-5">Lorem ipsum dolor sit amet consectetur adipisicing elit. Explicabo qui laboriosam nihil reiciendis fugit eius nostrum
            ipsum odio, voluptate debitis laborum perspiciatis voluptatibus? Culpa expedita rem totam eos fugit atque!</p>

        </div>
        -->

      </div>
      <!--Grid row-->



      <!--Grid row-->
      <div class="row text-center wow fadeIn">

        <!--Grid column-->
        <div class="col-lg-4 col-md-12 mb-4">

          <!--Card-->
          <div class="card">

            <!-- Card header -->
            <div class="card-header">
              <h4>
                <strong>Detail Set I</strong>
              </h4>
            </div>

            <!--Card content-->
            <div class="card-body">

      <table id="customers">
    <tr>
    <th>Tech Details</th>
    <td>{{data[21]}}</td>
  </tr>
  <tr>
    <th>Tender Category</th>
    <td>{{data[22]}}</td>
  </tr>
  <tr>
    <th>Tender Value</th>
    <td>{{data[23]}}</td>
</table>

            </div>

          </div>
          <!--/.Card-->

        </div>
        <!--Grid column-->



                <!--Grid column-->
        <div class="col-lg-4 col-md-12 mb-4">

          <!--Card-->
          <div class="card">

            <!-- Card header -->
            <div class="card-header">
              <h4>
                <strong>Detail Set II</strong>
              </h4>
            </div>

            <!--Card content-->
            <div class="card-body">

      <table id="customers">
    <tr>
    <th>TenderRef</th>
    <td>{{data[24]}}</td>
  </tr>
  <tr>
    <th>Tender Status</th>
    <td>{{data[25]}}</td>
  </tr>
  <tr>
    <th>Tender ID</th>
    <td>{{data[26]}}</td>
</table>

            </div>

          </div>
          <!--/.Card-->

        </div>
        <!--Grid column-->

                <!--Grid column-->
        <div class="col-lg-4 col-md-12 mb-4">

          <!--Card-->
          <div class="card">

            <!-- Card header -->
            <div class="card-header">
              <h4>
                <strong>Detail Set III</strong>
              </h4>
            </div>

            <!--Card content-->
            <div class="card-body">

      <table id="customers">
    <tr>
    <th>TenderFeExempt</th>
    <td>{{data[27]}}</td>
  </tr>
  <tr>
    <th>Title</th>
    <td>{{data[28]}}</td>
  </tr>
  <tr>
    <th>WorkDescription</th>
    <td>{{data[29]}}</td>
</table>

            </div>

          </div>
          <!--/.Card-->

        </div>
        <!--Grid column-->

<div class="col-md-6">
<center>
<iframe src="https://drive.google.com/file/d/140MHGaKp5jBvmh0qd8e7_mB_IBun4oyI/preview" frameborder="0" style="overflow:hidden;height:300px;" width="100%" height="580"></iframe>
</center>

</div>

{% if 'false' == isOpen %}

{% endif %}


{% if session['dealer_logged_in'] and 'true' == isOpen %}
<div class="col-md-6">
<form action="/tender/{{data[14]}}" method=post>
<center>

    <button id="close">Close Tender</button>
</center>
</form>

</div>
{% endif %}

{% if isOpen == "false" %}
<div class="col-md-6">
    <div class="container">
    <div id="box"></div>
    </div>
    <br>
    <font size="6"><strong>Tender CLOSED. Random selectors have been notified</strong></font>
    </div>
{% endif %}

{% if session['bid_submitted'] and not session['dealer_logged_in'] and not session['bid_complete'] %}
<div class="col-md-6">
<center><button type="submit" class="btn btn-primary disabled">{{status}}<br>{{amount}}</button></center>
</div>
{% else %}
{% if not session['dealer_logged_in'] and session['logged_in'] and 'true' == isOpen and "false" == hasBid %}
<div class="col-md-6">
<form action="/tender/{{data[14]}}" method=post>
<center>
<div class="card">
<div class="container">
    <center>

    <dl>

    <dt><label for="id">Bid Amount</label>
    <dd><input id="bidamt" name="bidamt" type="number" value="">

    </dd>

    </dl>

    <input type="checkbox" name="checkbox" value="agree"  >&nbsp;I hereby agree to the Terms <br>
    <p><button id="bid" name="bid" value="makebid" type="submit" class="btn btn-primary" onclick="if(!this.form.checkbox.checked){alert('You must agree to the terms first.');return false}" >Make Bid</button></p>

</center>
</div>
</div>
</form>


</div>
{% else %}

{% endif %}
{% endif %}
      <!--Grid row-->

    </div>
  </main>
  <!--Main layout-->

<!--Footer-->
  <footer class="page-footer text-center font-small mt-4 wow fadeIn">

    <!--Call to action-->
    <div class="pt-4">
      Transparency is open-source<br>
      <a class="btn btn-outline-white" href="https://github.com/936a185caaa266bb9cbe981e9e05cb/936a185caaa266bb9cbe981e9e05cb.github.io" target="_blank" role="button">View Code
        <i class="fa fa-github-alt ml-2"></i>
      </a>
    </div>
    <!--/.Call to action-->

    <hr class="my-4">

    <!--Copyright-->
    <div class="footer-copyright py-3">
      © 2018 Copyright:
      <a href="https://nextech.io" target="_blank"> nextech.io </a>
    </div>
    <!--/.Copyright-->

  </footer>
  <!--/.Footer-->

  <!-- SCRIPTS -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>

  <script>
     if(typeof web3 !== 'undefined')
     {
       web3 = new Web3(web3.currentProvider);
     }
     else
     {
       web3 = new Web3(new Web3.providers.HttpProvider("http://teamsatoshi.pythonanywhere.com/tender/"));
     }
     web3.version.getNetwork((err, netId) => {
switch (netId) {
  case "1":
    console.log('This is mainnet')
    break
  case "2":
    console.log('This is the deprecated Morden test network.')
    break
  case "3":
    console.log('This is the ropsten test network.')
    break
  case "4":
    console.log('This is the Rinkeby test network.')
    break
  case "42":
    console.log('This is the Kovan test network.')
    break
  default:
    console.log('This is an unknown network.')
}
})

     web3.eth.defaultAccount=web3.eth.accounts[0];

     var testContract = web3.eth.contract([
  {
    "constant": false,
    "inputs": [
      {
        "name": "myid",
        "type": "bytes32"
      },
      {
        "name": "result",
        "type": "string"
      },
      {
        "name": "proof",
        "type": "bytes"
      }
    ],
    "name": "__callback",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_oraclizeID",
        "type": "bytes32"
      },
      {
        "name": "_result",
        "type": "string"
      }
    ],
    "name": "__callback",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "regno",
        "type": "uint256"
      }
    ],
    "name": "add_selector",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "org",
        "type": "string"
      },
      {
        "name": "tenderRefNo",
        "type": "string"
      },
      {
        "name": "tenderID",
        "type": "uint256"
      },
      {
        "name": "tenderOpenStatus",
        "type": "bool"
      },
      {
        "name": "tenderCategory",
        "type": "string"
      },
      {
        "name": "techDoc",
        "type": "string"
      },
      {
        "name": "financeDoc",
        "type": "string"
      },
      {
        "name": "bidOpen",
        "type": "string"
      },
      {
        "name": "bidClose",
        "type": "string"
      },
      {
        "name": "tenderVal",
        "type": "uint256"
      }
    ],
    "name": "addTender",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "tender_uid",
        "type": "uint256"
      },
      {
        "name": "bid_det",
        "type": "uint256"
      }
    ],
    "name": "bid_to_tender",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "cname",
        "type": "string"
      },
      {
        "name": "reg",
        "type": "uint256"
      },
      {
        "name": "regadd",
        "type": "string"
      },
      {
        "name": "biddertype",
        "type": "string"
      },
      {
        "name": "city",
        "type": "string"
      },
      {
        "name": "state",
        "type": "string"
      },
      {
        "name": "post",
        "type": "uint256"
      },
      {
        "name": "pan",
        "type": "string"
      },
      {
        "name": "nature",
        "type": "string"
      },
      {
        "name": "legals",
        "type": "string"
      },
      {
        "name": "ccat",
        "type": "string"
      }
    ],
    "name": "bidderEnrollment",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "tender_id",
        "type": "uint256"
      }
    ],
    "name": "checkwinner",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [],
    "name": "getRandom",
    "outputs": [],
    "payable": true,
    "stateMutability": "payable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "rep_int",
        "type": "uint256"
      },
      {
        "name": "bidder_id",
        "type": "uint256"
      }
    ],
    "name": "give_vote",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "tenderid",
        "type": "uint256"
      },
      {
        "name": "bidder_reg_no",
        "type": "uint256"
      }
    ],
    "name": "opinion",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "tender_id",
        "type": "uint256"
      }
    ],
    "name": "selectrandomselector",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "constructor"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "tenderid",
        "type": "uint256"
      }
    ],
    "name": "displaybidders",
    "outputs": [
      {
        "name": "",
        "type": "uint256[]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "tenderid",
        "type": "uint256"
      }
    ],
    "name": "displaywinner",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "tender_id",
        "type": "uint256"
      }
    ],
    "name": "disselselectors",
    "outputs": [
      {
        "name": "",
        "type": "uint256[]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "gettenderarr",
    "outputs": [
      {
        "name": "",
        "type": "uint256[]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "oraclizeID",
    "outputs": [
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "result",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "selectedselectors",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "selectorarr",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "bidderid",
        "type": "uint256"
      }
    ],
    "name": "show_bidder_rating",
    "outputs": [
      {
        "name": "rating",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "tenderID",
        "type": "uint256"
      }
    ],
    "name": "showtenderdetails",
    "outputs": [
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "bool"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "tenderID",
        "type": "uint256"
      }
    ],
    "name": "showtenderdetails2",
    "outputs": [
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }
]);
var tender_id= {{data[6]}};
var test = testContract.at("0xc12e85dc500d5d93439f54193e16422b1e8d106c");
 $("#bid").click(function(){
   test.bid_to_tender(tender_id, $("#bidamt").val(), (error,result) => (console.log(result)));
 });

 $("#close").click(function() {
   test.selectrandomselector(tender_id,(error,result) => (console.log(result)));
 });

  test.displaybidders(tender_id,function(error,result) {
     if(!error)
     {

        var html = "Bidder IDs<br><li class=\"list-group-item\"><p><div class=\"row\">";

        for (var j = 1; j < result.length; j++)
            {
        html+="<div class=\"col-md-2\">"+result[j]+"</div>";

            }

                    html+="</div></p></li>";

document.getElementById("box").innerHTML += html;


     }
     else {
       console.log(error);
     }
   });
 </script>
  <!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <!-- Bootstrap tooltips -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/popper.min.js') }}"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/mdb.min.js') }}"></script>
  <!-- Initializations -->
  <script type="text/javascript">
    // Animations initialization
    new WOW().init();
  </script>
</body>

</html>
